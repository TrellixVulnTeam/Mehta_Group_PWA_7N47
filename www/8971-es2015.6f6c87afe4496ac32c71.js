(self.webpackChunkMehta=self.webpackChunkMehta||[]).push([[8971],{58971:function(t,e,n){"use strict";n.r(e),n.d(e,{AllocatePointFormPageModule:function(){return C}});var i=n(38583),o=n(90665),a=n(47823),s=n(12234),l=n(64762),c=n(56544),d=n(88720),r=n(14303),g=n(51532);function u(t,e){if(1&t&&(d.TgZ(0,"ion-select-option",13),d._uU(1),d.qZA()),2&t){const t=e.$implicit;d.Q6J("value",t),d.xp6(1),d.Oqu(null==t?null:t.budget_month)}}function h(t,e){if(1&t){const t=d.EpF();d.TgZ(0,"ion-item"),d.TgZ(1,"ion-label",6),d._uU(2,"Month"),d.qZA(),d.TgZ(3,"ion-select",11),d.NdJ("ngModelChange",function(e){return d.CHM(t),d.oxw().budMonthOpt=e})("ionChange",function(e){d.CHM(t);const n=d.oxw();return n.checkBudgetValue(e,n.budMonthOpt)}),d.YNc(4,u,2,2,"ion-select-option",12),d.qZA(),d.qZA()}if(2&t){const t=d.oxw();d.xp6(3),d.Q6J("ngModel",t.budMonthOpt),d.xp6(1),d.Q6J("ngForOf",t.budgetMonth)}}function p(t,e){if(1&t&&(d.TgZ(0,"ion-select-option",13),d._uU(1),d.qZA()),2&t){const t=e.$implicit;d.Q6J("value",t),d.xp6(1),d.hij("",null==t?null:t.brand_name," ")}}function m(t,e){if(1&t){const t=d.EpF();d.TgZ(0,"ion-item"),d.TgZ(1,"ion-label",6),d._uU(2,"Brands"),d.qZA(),d.TgZ(3,"ion-select",11),d.NdJ("ngModelChange",function(e){return d.CHM(t),d.oxw().brandOption=e})("ionChange",function(e){d.CHM(t);const n=d.oxw();return n.checkBrandValue(e,n.brandOption)}),d.YNc(4,p,2,2,"ion-select-option",12),d.qZA(),d.qZA()}if(2&t){const t=d.oxw();d.xp6(3),d.Q6J("ngModel",t.brandOption),d.xp6(1),d.Q6J("ngForOf",t.brandList)}}function b(t,e){if(1&t&&(d.TgZ(0,"ion-select-option",13),d._uU(1),d.qZA()),2&t){const t=e.$implicit;d.Q6J("value",t),d.xp6(1),d.hij(" ",null==t?null:t.product_name," ")}}function f(t,e){if(1&t){const t=d.EpF();d.TgZ(0,"ion-item"),d.TgZ(1,"ion-label",6),d._uU(2,"Product"),d.qZA(),d.TgZ(3,"ion-select",11),d.NdJ("ngModelChange",function(e){return d.CHM(t),d.oxw().productOption=e})("ionChange",function(e){d.CHM(t);const n=d.oxw();return n.checkProdValue(e,n.productOption)}),d.YNc(4,b,2,2,"ion-select-option",12),d.qZA(),d.qZA()}if(2&t){const t=d.oxw();d.xp6(3),d.Q6J("ngModel",t.productOption),d.xp6(1),d.Q6J("ngForOf",t.productList)}}function Z(t,e){if(1&t){const t=d.EpF();d.TgZ(0,"ion-item"),d.TgZ(1,"ion-label",6),d._uU(2,"Date"),d.qZA(),d.TgZ(3,"ion-datetime",14),d.NdJ("ngModelChange",function(e){return d.CHM(t),d.oxw().myDate=e}),d.qZA(),d._UZ(4,"ion-icon",15),d.qZA()}if(2&t){const t=d.oxw();d.xp6(3),d.s9C("min",t.minDate),d.s9C("max",t.maxDate),d.Q6J("ngModel",t.myDate)}}const x=[{path:"",component:(()=>{class t{constructor(t,e,n,i,o,a,s){this.apiService=t,this.zone=e,this.loadingController=n,this.navCtrl=i,this.sendData=o,this.route=a,this.modalCtrl=s,this.bagsCount="",this.pointAllocatedRes=0,this.btnText="Submit",this.btnDisable=!1,this.maxBagLimit=0,this.Invoice="",this.dealerHomeData=this.sendData.alldata,this.maxBagLimit=parseInt(this.sendData.alldata.max_bag_limit),console.log("previousePageData==> ",this.dealerHomeData),console.log("bag Count==",this.bagsCount)}ngOnInit(){this.fetchmonthData()}checkBagCount(t){console.log("bageCount",t),parseInt(t.detail.value)>this.dealerHomeData.max_bag_limit&&this.apiService.showToastMessage("Maximum "+this.dealerHomeData.max_bag_limit+" bags allowed","top",2e3,"redBg")}gotoHomeTab(){this.apiService.isSelected="true",console.log("this.apiService.isSelected000000",this.apiService.isSelected)}fetchmonthData(){return(0,l.mG)(this,void 0,void 0,function*(){this.loading=yield this.loadingController.create({cssClass:"my-custom-class",message:"Please wait..."}),yield this.loading.present(),this.apiService.apiCallWithLoginToken(c.n.searchApiUrl,{search_str:"",request_type:"brandAllocateMonth",request_user_type:this.dealerHomeData.employee_type}).subscribe(t=>{console.log("allocatedMonthData",t),this.loading.dismiss(),1==t.success?this.budgetMonth=t.data:(this.apiService.showToastMessage(JSON.stringify(t.message),"top",3e3,"redBg"),this.navCtrl.pop())},t=>{this.loading.dismiss(),this.apiService.showToastMessage(JSON.stringify(t),"top",3e3,"redBg")})})}fetchData(t,e){return(0,l.mG)(this,void 0,void 0,function*(){this.zone.run(()=>(0,l.mG)(this,void 0,void 0,function*(){let n=yield t;this.apiService.apiCallWithLoginToken(c.n.searchApiUrl,{search_str:"",request_type:n,request_user_type:this.dealerHomeData.employee_type,dealer_budget_id:this.budgetId}).subscribe(n=>{e==this.dataList.length-1&&this.loading.dismiss(),1==n.success?"product"==t?(this.productList=n.data,console.log("productlist==>",this.productList)):"brand"==t&&(this.brandList=n.data,console.log("brandList==>",this.brandList)):this.apiService.showToastMessage(n.message,"top",3e3,"redBg")},t=>{this.apiService.showToastMessage(JSON.stringify(t),"top",3e3,"redBg"),e==this.dataList.length-1&&this.loading.dismiss()})}))})}checkBrandValue(t,e){console.log("ev",t),console.log("brand data ",e),this.brandId=e.auto_id}checkProdValue(t,e){console.log("ev",t),console.log("prouct data ",e),this.prodId=e.auto_id,this.pointAllocatedRes=e.points_allocated}checkBudgetValue(t,e){return(0,l.mG)(this,void 0,void 0,function*(){console.log("ev",t),console.log("prouct data ",e),this.minDate=e.min_date,this.maxDate=e.max_date,this.budgetId=e.auto_id,this.dataList=["product","brand"];for(let t=0;t<this.dataList.length;t++)this.fetchData(this.dataList[t],t),0==t&&(this.loading=yield this.loadingController.create({cssClass:"my-custom-class",message:"Please wait..."}),yield this.loading.present())})}gotoSubmit(){this.zone.run(()=>(0,l.mG)(this,void 0,void 0,function*(){this.btnText="Please wait...",this.btnDisable=!0,this.apiService.apiCallWithLoginToken(c.n.pointAllocateApiUrl,{allocate_to:this.dealerHomeData.customer_id,brand_id:this.brandId,product_id:this.prodId,sell_date:this.myDate,bag_number:this.bagsCount,budget_id:this.budgetId,invoice_number:this.Invoice}).subscribe(t=>{this.btnText="Submit",this.btnDisable=!1,1==t.success?(this.myDate="",this.apiService.showToastMessage(t.message,"top",3e3,"greenBg"),this.bagsCount=""):this.apiService.showToastMessage(t.message,"top",3e3,"redBg")},t=>{this.apiService.showToastMessage(JSON.stringify(t),"top",3e3,"redBg")})}))}}return t.\u0275fac=function(e){return new(e||t)(d.Y36(r.s),d.Y36(d.R0b),d.Y36(a.HT),d.Y36(a.SH),d.Y36(g.b),d.Y36(s.F0),d.Y36(a.IN))},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-allocate-point-form"]],decls:32,vars:11,consts:[["slot","start","tappable","",3,"click"],[1,"ion-padding"],["size-sm","12","size-md","8","size-lg","8","push-lg","2","push-md","2",1,"whiteCol","ion-padding",3,"size"],["lines","none",1,"redbgDiv"],[1,"fullNamediv"],[4,"ngIf"],["position","stacked"],["type","text",3,"ngModel","ngModelChange"],["type","tel",3,"ngModel","ngModelChange","ionChange"],[1,"ion-text-center"],["tappable","",1,"ionic_btn","BTmmm",3,"disabled","click"],["okText","Okay","cancelText","Dismiss","interface","popover",3,"ngModel","ngModelChange","ionChange"],["class","w100",3,"value",4,"ngFor","ngForOf"],[1,"w100",3,"value"],["placeholder","Select Allocation Date","displayFormat","MMM/DD/YYYY",3,"min","max","ngModel","ngModelChange"],["name","calendar","slot","end"]],template:function(t,e){1&t&&(d.TgZ(0,"ion-header"),d.TgZ(1,"ion-toolbar"),d.TgZ(2,"ion-title"),d._uU(3,"Allocate Bags"),d.qZA(),d.TgZ(4,"ion-buttons",0),d.NdJ("click",function(){return e.gotoHomeTab()}),d._UZ(5,"ion-back-button"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(6,"ion-content",1),d.TgZ(7,"ion-row"),d.TgZ(8,"ion-col",2),d.TgZ(9,"ion-list"),d.TgZ(10,"ion-item",3),d.TgZ(11,"p",4),d._uU(12),d.qZA(),d.qZA(),d.YNc(13,h,5,2,"ion-item",5),d.YNc(14,m,5,2,"ion-item",5),d.YNc(15,f,5,2,"ion-item",5),d.YNc(16,Z,5,3,"ion-item",5),d.TgZ(17,"ion-item"),d.TgZ(18,"ion-label",6),d._uU(19,"Invoice\xa0No."),d.qZA(),d.TgZ(20,"ion-input",7),d.NdJ("ngModelChange",function(t){return e.Invoice=t}),d.qZA(),d.qZA(),d.TgZ(21,"ion-item"),d.TgZ(22,"ion-label",6),d._uU(23,"No. of Bags"),d.qZA(),d.TgZ(24,"ion-input",8),d.NdJ("ngModelChange",function(t){return e.bagsCount=t})("ionChange",function(t){return e.checkBagCount(t)}),d.qZA(),d.qZA(),d.qZA(),d._UZ(25,"br"),d.TgZ(26,"ion-row"),d.TgZ(27,"ion-col",9),d.TgZ(28,"ion-button",10),d.NdJ("click",function(){return e.gotoSubmit()}),d._uU(29),d.qZA(),d._UZ(30,"br"),d._UZ(31,"br"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&t&&(d.xp6(8),d.Q6J("size",12),d.xp6(4),d.AsE("",null==e.dealerHomeData?null:e.dealerHomeData.full_name,",\xa0",null==e.dealerHomeData?null:e.dealerHomeData.contact,""),d.xp6(1),d.Q6J("ngIf",e.budgetMonth&&(null==e.budgetMonth?null:e.budgetMonth.length)>=1),d.xp6(1),d.Q6J("ngIf",e.brandList&&(null==e.brandList?null:e.brandList.length)>=1),d.xp6(1),d.Q6J("ngIf",e.productList&&(null==e.productList?null:e.productList.length)>=1),d.xp6(1),d.Q6J("ngIf",e.brandList&&(null==e.brandList?null:e.brandList.length)>=1),d.xp6(4),d.Q6J("ngModel",e.Invoice),d.xp6(4),d.Q6J("ngModel",e.bagsCount),d.xp6(4),d.Q6J("disabled",!e.brandOption||!e.productOption||e.bagsCount<=0||1==e.btnDisable||!e.myDate||e.maxBagLimit<e.bagsCount),d.xp6(1),d.Oqu(e.btnText))},directives:[a.Gu,a.sr,a.wd,a.Sm,a.oU,a.cs,a.W2,a.Nd,a.wI,a.q_,a.Ie,i.O5,a.Q$,a.pK,a.j9,o.JJ,o.On,a.YG,a.t9,a.QI,i.sg,a.n0,a.x4,a.gu],styles:["ion-label[_ngcontent-%COMP%], p[_ngcontent-%COMP%]{color:var(--headerColor)!important}p.totalPoint[_ngcontent-%COMP%]{font-size:12px;font-weight:700}.container[_ngcontent-%COMP%]{padding:1% 5%}.whiteBg[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #cdcdcd;border-radius:10px;overflow:hidden;padding:10px;box-shadow:1px 1px 16px 1px #cdcdcd}.redbgDiv[_ngcontent-%COMP%]{--background:linear-gradient(195deg,#bb2929 57%,var(--headerColor) 33%)!important;border-radius:7px}.fullNamediv[_ngcontent-%COMP%]{color:#fff!important;font-weight:700;margin:6px 0}.BTmmm[_ngcontent-%COMP%]{width:60%!important}"]}),t})()}];let _=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({imports:[[s.Bz.forChild(x)],s.Bz]}),t})(),C=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({imports:[[i.ez,o.u5,a.Pc,_]]}),t})()}}]);