!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(self.webpackChunkMehta=self.webpackChunkMehta||[]).push([[8971],{58971:function(n,o,i){"use strict";i.r(o),i.d(o,{AllocatePointFormPageModule:function(){return w}});var a=i(38583),r=i(90665),s=i(47823),l=i(12234),c=i(64762),u=i(56544),d=i(88720),g=i(14303),p=i(51532);function h(e,t){if(1&e&&(d.TgZ(0,"ion-select-option",13),d._uU(1),d.qZA()),2&e){var n=t.$implicit;d.Q6J("value",n),d.xp6(1),d.Oqu(null==n?null:n.budget_month)}}function m(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"ion-item"),d.TgZ(1,"ion-label",6),d._uU(2,"Month"),d.qZA(),d.TgZ(3,"ion-select",11),d.NdJ("ngModelChange",function(e){return d.CHM(n),d.oxw().budMonthOpt=e})("ionChange",function(e){d.CHM(n);var t=d.oxw();return t.checkBudgetValue(e,t.budMonthOpt)}),d.YNc(4,h,2,2,"ion-select-option",12),d.qZA(),d.qZA()}if(2&e){var o=d.oxw();d.xp6(3),d.Q6J("ngModel",o.budMonthOpt),d.xp6(1),d.Q6J("ngForOf",o.budgetMonth)}}function f(e,t){if(1&e&&(d.TgZ(0,"ion-select-option",13),d._uU(1),d.qZA()),2&e){var n=t.$implicit;d.Q6J("value",n),d.xp6(1),d.hij("",null==n?null:n.brand_name," ")}}function b(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"ion-item"),d.TgZ(1,"ion-label",6),d._uU(2,"Brands"),d.qZA(),d.TgZ(3,"ion-select",11),d.NdJ("ngModelChange",function(e){return d.CHM(n),d.oxw().brandOption=e})("ionChange",function(e){d.CHM(n);var t=d.oxw();return t.checkBrandValue(e,t.brandOption)}),d.YNc(4,f,2,2,"ion-select-option",12),d.qZA(),d.qZA()}if(2&e){var o=d.oxw();d.xp6(3),d.Q6J("ngModel",o.brandOption),d.xp6(1),d.Q6J("ngForOf",o.brandList)}}function v(e,t){if(1&e&&(d.TgZ(0,"ion-select-option",13),d._uU(1),d.qZA()),2&e){var n=t.$implicit;d.Q6J("value",n),d.xp6(1),d.hij(" ",null==n?null:n.product_name," ")}}function x(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"ion-item"),d.TgZ(1,"ion-label",6),d._uU(2,"Product"),d.qZA(),d.TgZ(3,"ion-select",11),d.NdJ("ngModelChange",function(e){return d.CHM(n),d.oxw().productOption=e})("ionChange",function(e){d.CHM(n);var t=d.oxw();return t.checkProdValue(e,t.productOption)}),d.YNc(4,v,2,2,"ion-select-option",12),d.qZA(),d.qZA()}if(2&e){var o=d.oxw();d.xp6(3),d.Q6J("ngModel",o.productOption),d.xp6(1),d.Q6J("ngForOf",o.productList)}}function Z(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"ion-item"),d.TgZ(1,"ion-label",6),d._uU(2,"Date"),d.qZA(),d.TgZ(3,"ion-datetime",14),d.NdJ("ngModelChange",function(e){return d.CHM(n),d.oxw().myDate=e}),d.qZA(),d._UZ(4,"ion-icon",15),d.qZA()}if(2&e){var o=d.oxw();d.xp6(3),d.s9C("min",o.minDate),d.s9C("max",o.maxDate),d.Q6J("ngModel",o.myDate)}}var C,_,M=[{path:"",component:(C=function(){function n(t,o,i,a,r,s,l){e(this,n),this.apiService=t,this.zone=o,this.loadingController=i,this.navCtrl=a,this.sendData=r,this.route=s,this.modalCtrl=l,this.bagsCount="",this.pointAllocatedRes=0,this.btnText="Submit",this.btnDisable=!1,this.maxBagLimit=0,this.Invoice="",this.dealerHomeData=this.sendData.alldata,this.maxBagLimit=parseInt(this.sendData.alldata.max_bag_limit),console.log("previousePageData==> ",this.dealerHomeData),console.log("bag Count==",this.bagsCount)}var o,i,a;return o=n,(i=[{key:"ngOnInit",value:function(){this.fetchmonthData()}},{key:"checkBagCount",value:function(e){console.log("bageCount",e),parseInt(e.detail.value)>this.dealerHomeData.max_bag_limit&&this.apiService.showToastMessage("Maximum "+this.dealerHomeData.max_bag_limit+" bags allowed","top",2e3,"redBg")}},{key:"gotoHomeTab",value:function(){this.apiService.isSelected="true",console.log("this.apiService.isSelected000000",this.apiService.isSelected)}},{key:"fetchmonthData",value:function(){return(0,c.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadingController.create({cssClass:"my-custom-class",message:"Please wait..."});case 2:return this.loading=e.sent,e.next=5,this.loading.present();case 5:this.apiService.apiCallWithLoginToken(u.n.searchApiUrl,{search_str:"",request_type:"brandAllocateMonth",request_user_type:this.dealerHomeData.employee_type}).subscribe(function(e){console.log("allocatedMonthData",e),t.loading.dismiss(),1==e.success?t.budgetMonth=e.data:(t.apiService.showToastMessage(JSON.stringify(e.message),"top",3e3,"redBg"),t.navCtrl.pop())},function(e){t.loading.dismiss(),t.apiService.showToastMessage(JSON.stringify(e),"top",3e3,"redBg")});case 6:case"end":return e.stop()}},e,this)}))}},{key:"fetchData",value:function(e,t){return(0,c.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var o=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:this.zone.run(function(){return(0,c.mG)(o,void 0,void 0,regeneratorRuntime.mark(function n(){var o,i=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e;case 2:o=n.sent,this.apiService.apiCallWithLoginToken(u.n.searchApiUrl,{search_str:"",request_type:o,request_user_type:this.dealerHomeData.employee_type,dealer_budget_id:this.budgetId}).subscribe(function(n){t==i.dataList.length-1&&i.loading.dismiss(),1==n.success?"product"==e?(i.productList=n.data,console.log("productlist==>",i.productList)):"brand"==e&&(i.brandList=n.data,console.log("brandList==>",i.brandList)):i.apiService.showToastMessage(n.message,"top",3e3,"redBg")},function(e){i.apiService.showToastMessage(JSON.stringify(e),"top",3e3,"redBg"),t==i.dataList.length-1&&i.loading.dismiss()});case 4:case"end":return n.stop()}},n,this)}))});case 1:case"end":return n.stop()}},n,this)}))}},{key:"checkBrandValue",value:function(e,t){console.log("ev",e),console.log("brand data ",t),this.brandId=t.auto_id}},{key:"checkProdValue",value:function(e,t){console.log("ev",e),console.log("prouct data ",t),this.prodId=t.auto_id,this.pointAllocatedRes=t.points_allocated}},{key:"checkBudgetValue",value:function(e,t){return(0,c.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:console.log("ev",e),console.log("prouct data ",t),this.minDate=t.min_date,this.maxDate=t.max_date,this.budgetId=t.auto_id,this.dataList=["product","brand"],o=0;case 2:if(!(o<this.dataList.length)){n.next=14;break}if(this.fetchData(this.dataList[o],o),n.t0=0==o,!n.t0){n.next=11;break}return n.next=8,this.loadingController.create({cssClass:"my-custom-class",message:"Please wait..."});case 8:return this.loading=n.sent,n.next=11,this.loading.present();case 11:o++,n.next=2;break;case 14:case"end":return n.stop()}},n,this)}))}},{key:"gotoSubmit",value:function(){var e=this;this.zone.run(function(){return(0,c.mG)(e,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.btnText="Please wait...",this.btnDisable=!0,this.apiService.apiCallWithLoginToken(u.n.pointAllocateApiUrl,{allocate_to:this.dealerHomeData.customer_id,brand_id:this.brandId,product_id:this.prodId,sell_date:this.myDate,bag_number:this.bagsCount,budget_id:this.budgetId,invoice_number:this.Invoice}).subscribe(function(e){t.btnText="Submit",t.btnDisable=!1,1==e.success?(t.myDate="",t.apiService.showToastMessage(e.message,"top",3e3,"greenBg"),t.bagsCount=""):t.apiService.showToastMessage(e.message,"top",3e3,"redBg")},function(e){t.apiService.showToastMessage(JSON.stringify(e),"top",3e3,"redBg")});case 1:case"end":return e.stop()}},e,this)}))})}}])&&t(o.prototype,i),a&&t(o,a),n}(),C.\u0275fac=function(e){return new(e||C)(d.Y36(g.s),d.Y36(d.R0b),d.Y36(s.HT),d.Y36(s.SH),d.Y36(p.b),d.Y36(l.F0),d.Y36(s.IN))},C.\u0275cmp=d.Xpm({type:C,selectors:[["app-allocate-point-form"]],decls:32,vars:11,consts:[["slot","start","tappable","",3,"click"],[1,"ion-padding"],["size-sm","12","size-md","8","size-lg","8","push-lg","2","push-md","2",1,"whiteCol","ion-padding",3,"size"],["lines","none",1,"redbgDiv"],[1,"fullNamediv"],[4,"ngIf"],["position","stacked"],["type","text",3,"ngModel","ngModelChange"],["type","tel",3,"ngModel","ngModelChange","ionChange"],[1,"ion-text-center"],["tappable","",1,"ionic_btn","BTmmm",3,"disabled","click"],["okText","Okay","cancelText","Dismiss","interface","popover",3,"ngModel","ngModelChange","ionChange"],["class","w100",3,"value",4,"ngFor","ngForOf"],[1,"w100",3,"value"],["placeholder","Select Allocation Date","displayFormat","MMM/DD/YYYY",3,"min","max","ngModel","ngModelChange"],["name","calendar","slot","end"]],template:function(e,t){1&e&&(d.TgZ(0,"ion-header"),d.TgZ(1,"ion-toolbar"),d.TgZ(2,"ion-title"),d._uU(3,"Allocate Bags"),d.qZA(),d.TgZ(4,"ion-buttons",0),d.NdJ("click",function(){return t.gotoHomeTab()}),d._UZ(5,"ion-back-button"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(6,"ion-content",1),d.TgZ(7,"ion-row"),d.TgZ(8,"ion-col",2),d.TgZ(9,"ion-list"),d.TgZ(10,"ion-item",3),d.TgZ(11,"p",4),d._uU(12),d.qZA(),d.qZA(),d.YNc(13,m,5,2,"ion-item",5),d.YNc(14,b,5,2,"ion-item",5),d.YNc(15,x,5,2,"ion-item",5),d.YNc(16,Z,5,3,"ion-item",5),d.TgZ(17,"ion-item"),d.TgZ(18,"ion-label",6),d._uU(19,"Invoice\xa0No."),d.qZA(),d.TgZ(20,"ion-input",7),d.NdJ("ngModelChange",function(e){return t.Invoice=e}),d.qZA(),d.qZA(),d.TgZ(21,"ion-item"),d.TgZ(22,"ion-label",6),d._uU(23,"No. of Bags"),d.qZA(),d.TgZ(24,"ion-input",8),d.NdJ("ngModelChange",function(e){return t.bagsCount=e})("ionChange",function(e){return t.checkBagCount(e)}),d.qZA(),d.qZA(),d.qZA(),d._UZ(25,"br"),d.TgZ(26,"ion-row"),d.TgZ(27,"ion-col",9),d.TgZ(28,"ion-button",10),d.NdJ("click",function(){return t.gotoSubmit()}),d._uU(29),d.qZA(),d._UZ(30,"br"),d._UZ(31,"br"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&e&&(d.xp6(8),d.Q6J("size",12),d.xp6(4),d.AsE("",null==t.dealerHomeData?null:t.dealerHomeData.full_name,",\xa0",null==t.dealerHomeData?null:t.dealerHomeData.contact,""),d.xp6(1),d.Q6J("ngIf",t.budgetMonth&&(null==t.budgetMonth?null:t.budgetMonth.length)>=1),d.xp6(1),d.Q6J("ngIf",t.brandList&&(null==t.brandList?null:t.brandList.length)>=1),d.xp6(1),d.Q6J("ngIf",t.productList&&(null==t.productList?null:t.productList.length)>=1),d.xp6(1),d.Q6J("ngIf",t.brandList&&(null==t.brandList?null:t.brandList.length)>=1),d.xp6(4),d.Q6J("ngModel",t.Invoice),d.xp6(4),d.Q6J("ngModel",t.bagsCount),d.xp6(4),d.Q6J("disabled",!t.brandOption||!t.productOption||t.bagsCount<=0||1==t.btnDisable||!t.myDate||t.maxBagLimit<t.bagsCount),d.xp6(1),d.Oqu(t.btnText))},directives:[s.Gu,s.sr,s.wd,s.Sm,s.oU,s.cs,s.W2,s.Nd,s.wI,s.q_,s.Ie,a.O5,s.Q$,s.pK,s.j9,r.JJ,r.On,s.YG,s.t9,s.QI,a.sg,s.n0,s.x4,s.gu],styles:["ion-label[_ngcontent-%COMP%], p[_ngcontent-%COMP%]{color:var(--headerColor)!important}p.totalPoint[_ngcontent-%COMP%]{font-size:12px;font-weight:700}.container[_ngcontent-%COMP%]{padding:1% 5%}.whiteBg[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #cdcdcd;border-radius:10px;overflow:hidden;padding:10px;box-shadow:1px 1px 16px 1px #cdcdcd}.redbgDiv[_ngcontent-%COMP%]{--background:linear-gradient(195deg,#bb2929 57%,var(--headerColor) 33%)!important;border-radius:7px}.fullNamediv[_ngcontent-%COMP%]{color:#fff!important;font-weight:700;margin:6px 0}.BTmmm[_ngcontent-%COMP%]{width:60%!important}"]}),C)}],T=function(){var t=function t(){e(this,t)};return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({imports:[[l.Bz.forChild(M)],l.Bz]}),t}(),w=((_=function t(){e(this,t)}).\u0275fac=function(e){return new(e||_)},_.\u0275mod=d.oAB({type:_}),_.\u0275inj=d.cJS({imports:[[a.ez,r.u5,s.Pc,T]]}),_)}}])}();